<?xml version="1.0" encoding="UTF-8"?>

<document repository="default" id="b52e4fa2-19dd-4432-a4aa-622d55ce7113">
  <system>
    <type>ProcedureModel</type>
    <path>invitation</path>
    <lifecycle-state>project</lifecycle-state>
    <lifecycle-policy>default</lifecycle-policy>
    <facet>Versionable</facet>
    <access-control>
      <acl name="inherited">
        <entry principal="admin" permission="Everything" grant="true"/>
        <entry principal="Administrator" permission="Everything" grant="true"/>
        <entry principal="members" permission="Read" grant="true"/>
      </acl>
    </access-control>
  </system>
  <schema xmlns:uid="http://project.nuxeo.com/geide/schemas/uid/" name="uid">
    <uid:uid/>
    <uid:minor_version/>
    <uid:major_version/>
  </schema>
  <schema xmlns:dc="http://www.nuxeo.org/ecm/schemas/dublincore/" name="dublincore">
    <dc:creator><![CDATA[admin]]></dc:creator>
    <dc:source/>
    <dc:nature/>
    <dc:contributors>
      <item><![CDATA[admin]]></item>
    </dc:contributors>
    <dc:created><![CDATA[2016-07-25T12:56:22.05Z]]></dc:created>
    <dc:description/>
    <dc:rights/>
    <dc:subjects/>
    <dc:publisher/>
    <dc:valid/>
    <dc:format/>
    <dc:issued/>
    <dc:modified><![CDATA[2016-10-04T14:28:46.00Z]]></dc:modified>
    <dc:language/>
    <dc:coverage/>
    <dc:expired/>
    <dc:lastContributor><![CDATA[admin]]></dc:lastContributor>
    <dc:title><![CDATA[Invitation]]></dc:title>
  </schema>
  <schema xmlns:ttc="http://www.nuxeo.org/ecm/project/schemas/ACRENNES2/toutatice" name="toutatice">
    <ttc:queryPart/>
    <ttc:selectors/>
    <ttc:childrenPageTemplate/>
    <ttc:contextualizeExternalContents><![CDATA[false]]></ttc:contextualizeExternalContents>
    <ttc:hiddenInNavigation/>
    <ttc:isOnline><![CDATA[false]]></ttc:isOnline>
    <ttc:showInMenu><![CDATA[false]]></ttc:showInMenu>
    <ttc:spaceID><![CDATA[efd9c70f-5279-4ecb-8b8c-4c03942e659d]]></ttc:spaceID>
    <ttc:tabOrder><![CDATA[0]]></ttc:tabOrder>
    <ttc:contextualizeInternalContents><![CDATA[false]]></ttc:contextualizeInternalContents>
    <ttc:pageScope/>
    <ttc:extensionUrl/>
    <ttc:isPreloadedOnLogin><![CDATA[false]]></ttc:isPreloadedOnLogin>
    <ttc:domainID><![CDATA[default-domain]]></ttc:domainID>
    <ttc:webid><![CDATA[procedure_invitation]]></ttc:webid>
    <ttc:keywords/>
    <ttc:editorialTitle/>
    <ttc:vignette/>
    <ttc:abstract/>
    <ttc:pageTemplate/>
    <ttc:images/>
    <ttc:theme/>
    <ttc:explicitUrl/>
    <ttc:lstTargetedPublic/>
    <ttc:useES><![CDATA[false]]></ttc:useES>
  </schema>
  <schema xmlns:pcd="http://www.nuxeo.org/ecm/project/schemas/osivia/models/procedure" name="procedure">
    <pcd:startingStep><![CDATA[init]]></pcd:startingStep>
    <pcd:globalVariablesDefinitions/>
    <pcd:authorizedActors/>
    <pcd:steps>
      <step>
        <stringMsg><![CDATA[]]></stringMsg>
        <index><![CDATA[0]]></index>
        <authorizedGroups/>
        <actionIdYes><![CDATA[]]></actionIdYes>
        <actionIdClosable><![CDATA[]]></actionIdClosable>
        <reference><![CDATA[init]]></reference>
        <acquitable><![CDATA[false]]></acquitable>
        <closable><![CDATA[false]]></closable>
        <globalVariablesReferences/>
        <name><![CDATA[Initialisation]]></name>
        <actionIdDefault><![CDATA[start]]></actionIdDefault>
        <notifiable><![CDATA[false]]></notifiable>
        <actions>
          <action>
            <filtersList>
              <filter>
                <filterInstanceId><![CDATA[IfFilter1]]></filterInstanceId>
                <filterId><![CDATA[IfFilter]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${not newUser}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[IfCondition]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[Si user enregistré]]></filterName>
                <filterPath><![CDATA[1]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[IfFilter2]]></filterInstanceId>
                <filterId><![CDATA[IfFilter]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${newUser}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[IfCondition]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[Si user non enregistré]]></filterName>
                <filterPath><![CDATA[2]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[SET_ACTOR0]]></filterInstanceId>
                <filterId><![CDATA[SET_ACTOR]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${uid}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[actor]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[0]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[SendMailFilter2,0]]></filterInstanceId>
                <filterId><![CDATA[SendMailFilter]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${user:name(procedureInitiator)} vous a invité à rejoindre l'espace ${document:title(documentPath)}.
${command:link("Accepter", "accept", documentPath)}.

Vous pouvez vous connecter en utilisant les identifiants suivants :

Login : ${uid}
Mot de passe : ${generatedPassword}]]></argumentValue>
                    <argumentType><![CDATA[TEXTAREA]]></argumentType>
                    <argumentName><![CDATA[body]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(procedureInitiator)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailFrom]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(uid)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailTo]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[Invitation à rejoindre un espace]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailObject]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[true]]></argumentValue>
                    <argumentType><![CDATA[BOOLEAN]]></argumentType>
                    <argumentName><![CDATA[continue]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[Mail d'inscription]]></filterName>
                <filterPath><![CDATA[2,0]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[SendMailFilter1,0]]></filterInstanceId>
                <filterId><![CDATA[SendMailFilter]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${user:name(procedureInitiator)} vous a invité à rejoindre l'espace ${document:title(documentPath)}.
${command:link("Accepter", "accept", documentPath)}]]></argumentValue>
                    <argumentType><![CDATA[TEXTAREA]]></argumentType>
                    <argumentName><![CDATA[body]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(procedureInitiator)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailFrom]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(uid)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailTo]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[Invitation à rejoindre un espace]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailObject]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[true]]></argumentValue>
                    <argumentType><![CDATA[BOOLEAN]]></argumentType>
                    <argumentName><![CDATA[continue]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[Mail pour rejoindre l'espace]]></filterName>
                <filterPath><![CDATA[1,0]]></filterPath>
              </filter>
            </filtersList>
            <label><![CDATA[Démarrer]]></label>
            <actionId><![CDATA[start]]></actionId>
            <stepReference><![CDATA[invitation]]></stepReference>
          </action>
        </actions>
        <actionIdNo><![CDATA[]]></actionIdNo>
      </step>
      <step>
        <stringMsg><![CDATA[${user:link(procedureInitiator)} vous a invité à rejoindre l'espace ${workspaceTitle}.]]></stringMsg>
        <index><![CDATA[1]]></index>
        <authorizedGroups/>
        <actionIdYes><![CDATA[accept]]></actionIdYes>
        <actionIdClosable><![CDATA[]]></actionIdClosable>
        <reference><![CDATA[invitation]]></reference>
        <acquitable><![CDATA[true]]></acquitable>
        <closable><![CDATA[false]]></closable>
        <globalVariablesReferences/>
        <name><![CDATA[Invitation]]></name>
        <actionIdDefault><![CDATA[]]></actionIdDefault>
        <notifiable><![CDATA[true]]></notifiable>
        <actions>
          <action>
            <filtersList>
              <filter>
                <filterInstanceId><![CDATA[ACCEPT_WORKSPACE_INVITATION0]]></filterInstanceId>
                <filterId><![CDATA[ACCEPT_WORKSPACE_INVITATION]]></filterId>
                <argumentsList/>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[0]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[SET_NOTIFICATION_MESSAGE1]]></filterInstanceId>
                <filterId><![CDATA[SET_NOTIFICATION_MESSAGE]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[Vous êtes désormais membre de l'espace ${document:link(documentPath)}.]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[message]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[1]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[DeleteOnEnding2]]></filterInstanceId>
                <filterId><![CDATA[DeleteOnEnding]]></filterId>
                <argumentsList/>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[2]]></filterPath>
              </filter>
            </filtersList>
            <label><![CDATA[Accepter]]></label>
            <actionId><![CDATA[accept]]></actionId>
            <stepReference><![CDATA[endStep]]></stepReference>
          </action>
          <action>
            <filtersList>
              <filter>
                <filterInstanceId><![CDATA[SendMailFilter2]]></filterInstanceId>
                <filterId><![CDATA[SendMailFilter]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${user:name(uid)} a refusé votre invitation à rejoindre l'espace ${workspaceTitle}.]]></argumentValue>
                    <argumentType><![CDATA[TEXTAREA]]></argumentType>
                    <argumentName><![CDATA[body]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(uid)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailFrom]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:email(procedureInitiator)}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailTo]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[${user:name(uid)} a refusé votre invitation]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[mailObject]]></argumentName>
                  </argument>
                  <argument>
                    <argumentValue><![CDATA[true]]></argumentValue>
                    <argumentType><![CDATA[BOOLEAN]]></argumentType>
                    <argumentName><![CDATA[continue]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[Notifier par email]]></filterName>
                <filterPath><![CDATA[2]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[DECLINE_WORKSPACE_INVITATION0]]></filterInstanceId>
                <filterId><![CDATA[DECLINE_WORKSPACE_INVITATION]]></filterId>
                <argumentsList/>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[0]]></filterPath>
              </filter>
              <filter>
                <filterInstanceId><![CDATA[SET_ACTOR1]]></filterInstanceId>
                <filterId><![CDATA[SET_ACTOR]]></filterId>
                <argumentsList>
                  <argument>
                    <argumentValue><![CDATA[${procedureInitiator}]]></argumentValue>
                    <argumentType><![CDATA[TEXT]]></argumentType>
                    <argumentName><![CDATA[actor]]></argumentName>
                  </argument>
                </argumentsList>
                <filterName><![CDATA[]]></filterName>
                <filterPath><![CDATA[1]]></filterPath>
              </filter>
            </filtersList>
            <label><![CDATA[Refuser]]></label>
            <actionId><![CDATA[decline]]></actionId>
            <stepReference><![CDATA[declined]]></stepReference>
          </action>
        </actions>
        <actionIdNo><![CDATA[decline]]></actionIdNo>
      </step>
      <step>
        <stringMsg><![CDATA[${user:link(uid)} a refusé l'invitation à rejoindre l'espace ${document:link(documentPath)}.]]></stringMsg>
        <index><![CDATA[2]]></index>
        <authorizedGroups/>
        <actionIdYes><![CDATA[]]></actionIdYes>
        <actionIdClosable><![CDATA[close]]></actionIdClosable>
        <reference><![CDATA[declined]]></reference>
        <acquitable><![CDATA[false]]></acquitable>
        <closable><![CDATA[true]]></closable>
        <globalVariablesReferences/>
        <name><![CDATA[Invitation refusée]]></name>
        <actionIdDefault><![CDATA[]]></actionIdDefault>
        <notifiable><![CDATA[true]]></notifiable>
        <actions>
          <action>
            <filtersList/>
            <label><![CDATA[Fermer]]></label>
            <actionId><![CDATA[close]]></actionId>
            <stepReference><![CDATA[endStep]]></stepReference>
          </action>
        </actions>
        <actionIdNo><![CDATA[]]></actionIdNo>
      </step>
    </pcd:steps>
    <pcd:authorizedGroups/>
    <pcd:procedureObjects/>
  </schema>
</document>
